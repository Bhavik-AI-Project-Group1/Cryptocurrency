import pandas as pd

# Load the CSV files
file1 = "/content/mod2_kag.csv"
file2 = "/content/modified_file (1).csv"
file3 = "/content/need_merge1.csv"
file4 = "/content/need_merge2.csv"
file5 = "/content/real_mod.csv"
file6 = "/content/ripple2.csv"
file7 = "/content/ripple_crypto_historical_data.csv"

df1 = pd.read_csv(file1)
df2 = pd.read_csv(file2)
df3 = pd.read_csv(file3)
df4 = pd.read_csv(file4)
df5 = pd.read_csv(file5)
df6 = pd.read_csv(file6)
df7 = pd.read_csv(file7)

# Standardize column headers by stripping whitespace and converting to lowercase
dfs = [df1, df2, df3, df4, df5, df6, df7]
for i in range(len(dfs)):
    dfs[i].columns = dfs[i].columns.str.strip().str.lower()

# Merge dataframes on common columns without losing data
merged_df = df1
for df in dfs[1:]:
    common_columns = merged_df.columns.intersection(df.columns).tolist()  # Find common columns for merging
    if common_columns:
        merged_df = pd.merge(merged_df, df, on=common_columns, how='outer')
    else:
        merged_df = pd.concat([merged_df, df], axis=1)  # If no common columns, concatenate side-by-side

# Save the merged data to a new CSV file
merged_file = "merged_ripbit2.csv"
merged_df.to_csv(merged_file, index=False)

print(f"Merged file saved as {merged_file}")